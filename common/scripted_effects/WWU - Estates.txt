#Scripted effects for estates

# Will apply effect if estate is present
# effect: Will apply effect to each estate present if defined
# <estate>_effect: Will apply effect to specific estate present if defined
each_estate_effect = {
	if = {
		limit = {
			has_estate = estate_clergy
		}
		[[effect]
			$effect$
		]
		[[clergy_effect]
			$clergy_effect$
		]
	}
	if = {
		limit = {
			has_estate = estate_traders
		}
		[[effect]
			$effect$
		]
		[[traders_effect]
			$traders_effect$
		]
	}
	if = {
		limit = {
			has_estate = estate_nobility
		}
		[[effect]
			$effect$
		]
		[[nobility_effect]
			$nobility_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_peasants
		}
		[[effect]
			$effect$
		]
		[[peasants_effect]
			$peasants_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_slaves
		}
		[[effect]
			$effect$
		]
		[[slaves_effect]
			$slaves_effect$
		]
	}
	if = {
		limit = {
			has_estate = estate_tribals
		}
		[[effect]
			$effect$
		]
		[[tribals_effect]
			$tribals_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_mercantile_guild
		}
		[[effect]
			$effect$
		]
		[[mercantile_guild_effect]
			$mercantile_guild_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_criminal_syndicate
		}
		[[effect]
			$effect$
		]
		[[criminal_syndicate_effect]
			$criminal_syndicate_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_warriors_guild
		}
		[[effect]
			$effect$
		]
		[[warriors_guild_effect]
			$warriors_guild_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_religious_order
		}
		[[effect]
			$effect$
		]
		[[religious_order_effect]
			$religious_order_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_adventuring_guild
		}
		[[effect]
			$effect$
		]
		[[adventuring_guild_effect]
			$adventuring_guild_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_reliquary
		}
		[[effect]
			$effect$
		]
		[[reliquary_effect]
			$reliquary_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_explorers_league
		}
		[[effect]
			$effect$
		]
		[[explorers_league_effect]
			$explorers_league_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_invention
		}
		[[effect]
			$effect$
		]
		[[invention_effect]
			$invention_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_legion
		}
		[[effect]
			$effect$
		]
		[[legion_effect]
			$legion_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_abyssal_maw
		}
		[[effect]
			$effect$
		]
		[[abyssal_maw_effect]
			$abyssal_maw_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_firelands
		}
		[[effect]
			$effect$
		]
		[[firelands_effect]
			$firelands_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_deepholm
		}
		[[effect]
			$effect$
		]
		[[deepholm_effect]
			$deepholm_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_skywall
		}
		[[effect]
			$effect$
		]
		[[skywall_effect]
			$skywall_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_loa
		}
		[[effect]
			$effect$
		]
		[[loa_effect]
			$loa_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_dragonflight
		}
		[[effect]
			$effect$
		]
		[[dragonflight_effect]
			$dragonflight_effect$
		]
	}
    if = {
		limit = {
			has_estate = estate_underling
		}
		[[effect]
			$effect$
		]
		[[underling_effect]
			$underling_effect$
		]
	}
}

#Estate Privilege on_action effects
on_religion_change_estate_privileges_effect = {
	if = {
		limit = {
			any_country = {
				root = {
					force_converted_by = prev
					religion = prev
				}
			}
		}
		random_country = {
			limit = {
				root = {
					force_converted_by = prev
					religion = prev
				}
			}
			add_country_modifier = {
				name = recently_force_converted_protagonist_timer
				duration = 5475
				hidden = yes
			}
		}
	}
}

on_annexed_estate_privileges_effect = {
	if = {
		limit = {
			from = {
				NOT = { religion = root }
			}
		}
		add_country_modifier = {
			name = recently_annexed_other_religion_timer
			duration = 5475
			hidden = yes
		}
	}
}

on_province_religion_converted_estate_privileges_effect = {
	if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_increased_taxation
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_peasants_increased_taxation_mod }
			}
			add_province_modifier = {
				name = estate_peasants_increased_taxation_mod
				duration = -1
			}
		}
	}
	if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_manpower
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_peasants_manpower_mod }
			}
			add_province_modifier = {
				name = estate_peasants_manpower_mod
				duration = -1
			}
		}
	}
	if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_guaranteed_autonomy
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_peasants_guaranteed_autonomy_mod }
			}
			add_province_modifier = {
				name = estate_peasants_guaranteed_autonomy_mod
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_serfdom_enforced
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_peasants_serfdom_enforced_mod }
			}
			add_province_modifier = {
				name = estate_peasants_serfdom_enforced_mod
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_sell_slaves
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_slave_markets }
                NOT = { has_owner_accepted_culture = yes }
                NOT = { has_owner_culture = yes }
			}
			add_province_modifier = {
				name = estate_slaves_slave_markets
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslave_race
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_enslaved }
                NOT = { has_owner_accepted_culture = yes }
                NOT = { has_owner_culture = yes }
			}
			add_province_modifier = {
				name = estate_slaves_enslaved
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslaved_farmhands
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_slave_plantations }
                has_terrain = farmlands
			}
			add_province_modifier = {
				name = estate_slaves_slave_plantations
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslaved_miners
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_slave_mines }
                has_terrain = mountain
			}
			add_province_modifier = {
				name = estate_slaves_slave_mines
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_conscripted_slaves
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_slave_garrison }
                has_terrain = passage
			}
			add_province_modifier = {
				name = estate_slaves_slave_garrison
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_gladiatorial_games
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_gladiatorial_games_mod }
                has_terrain = urban
			}
			add_province_modifier = {
				name = estate_slaves_gladiatorial_games_mod
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslaved_sailors
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_coastal_serfs }
                has_port = yes
			}
			add_province_modifier = {
				name = estate_slaves_coastal_serfs
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_indentured_servants
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_personal_servants }
                has_terrain = urban
			}
			add_province_modifier = {
				name = estate_slaves_personal_servants
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_cruel_experimentation
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_experiments }
                has_terrain = urban
			}
			add_province_modifier = {
				name = estate_slaves_experiments
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_indentured_clerks
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_bureaucratic_servants }
                has_terrain = urban
			}
			add_province_modifier = {
				name = estate_slaves_bureaucratic_servants
				duration = -1
			}
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_restraining_bolts
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = estate_slaves_restraining_bolt }
                NOT = { has_owner_accepted_culture = yes }
                NOT = { has_owner_culture = yes }
			}
			add_province_modifier = {
				name = estate_slaves_restraining_bolt
				duration = -1
			}
		}
	}
}

on_province_owner_change_estate_privileges_effect = {
    #----------------------
    # Battleworn
    #----------------------
    if = {
        limit = {
            owner = {
                has_estate_privilege = estate_adventuring_guild_adventurers_in_the_army
            }
            NOT = { has_province_modifier = adventurer_province }
        }
        
        add_permanent_province_modifier = {
            name = adventurer_province
            duration = -1
        }
    }
    if = {
        limit = {
            owner = {
                NOT = { has_estate_privilege = estate_adventuring_guild_adventurers_in_the_army }
            }
            has_province_modifier = adventurer_province
        }
        
        remove_province_modifier = adventurer_province
    }
    
    #----------------------
    # Peasants
    #----------------------
	if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_increased_taxation
			}
		}
		add_province_modifier = {
			name = estate_peasants_increased_taxation_mod
			duration = -1
		}
	}
	if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_manpower
			}
		}
		add_province_modifier = {
			name = estate_peasants_manpower_mod
			duration = -1
		}
	}
	if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_guaranteed_autonomy
			}
		}
		add_province_modifier = {
			name = estate_peasants_guaranteed_autonomy_mod
			duration = -1
		}
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_peasants_serfdom_enforced
			}
		}
        add_province_modifier = {
            name = estate_peasants_serfdom_enforced_mod
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_sell_slaves
			}
            NOT = { has_owner_accepted_culture = yes }
            NOT = { has_owner_culture = yes }
		}
        add_province_modifier = {
            name = estate_slaves_slave_markets
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslave_race
			}
            NOT = { has_owner_accepted_culture = yes }
            NOT = { has_owner_culture = yes }
		}
        add_province_modifier = {
            name = estate_slaves_enslaved
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslaved_farmhands
			}
            has_terrain = farmlands
		}
		add_province_modifier = {
            name = estate_slaves_slave_plantations
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslaved_miners
			}
            has_terrain = mountain
		}
		add_province_modifier = {
            name = estate_slaves_slave_mines
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_conscripted_slaves
			}
            has_terrain = passage
		}
		add_province_modifier = {
            name = estate_slaves_slave_garrison
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_gladiatorial_games
			}
            has_terrain = urban
		}
		add_province_modifier = {
            name = estate_slaves_gladiatorial_games_mod
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_enslaved_sailors
			}
            has_port = yes
		}
		add_province_modifier = {
            name = estate_slaves_coastal_serfs
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_indentured_servants
			}
            has_terrain = urban
		}
		add_province_modifier = {
            name = estate_slaves_personal_servants
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_cruel_experimentation
			}
            has_terrain = urban
		}
		add_province_modifier = {
            name = estate_slaves_experiments
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_indentured_clerks
			}
            has_terrain = urban
		}
		add_province_modifier = {
            name = estate_slaves_bureaucratic_servants
            duration = -1
        }
	}
    if = {
		limit = {
			owner = {
				has_estate_privilege = estate_slaves_restraining_bolts
			}
            NOT = { has_owner_accepted_culture = yes }
            NOT = { has_owner_culture = yes }
		}
        add_province_modifier = {
            name = estate_slaves_restraining_bolt
            duration = -1
        }
	}
}

on_loan_repaid_estate_privileges_effect = {
	if = {
		limit = {
			has_estate_privilege = estate_traders_indebted_to_merchants
			NOT = { has_estate_loan = 1 }
		}
		remove_estate_privilege = estate_traders_indebted_to_merchants
	}
    if = {
		limit = {
			has_estate_privilege = estate_traders_goblin_bankers
			NOT = { has_estate_loan = 1 }
		}
		remove_estate_privilege = estate_traders_goblin_bankers
	}
}

on_trade_good_changed_estate_privileges_effect = {
    
}

reapply_estate_privilege = {
	# privilege: The privilege we want to reapply
	if = {
		limit = { 
			can_revoke_estate_privilege = $privilege$
		}
		hidden_effect = {
			remove_estate_privilege = $privilege$
		}
		set_estate_privilege = $privilege$
	}
}

scaled_estate_clergy_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_clergy }
}

scaled_estate_traders_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_traders }
}

scaled_estate_nobility_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_nobility }
}

scaled_estate_peasants_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_peasants }
}

scaled_estate_slaves_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_slaves }
}

scaled_estate_tribals_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_tribals }
}

scaled_estate_adventuring_guild_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_adventuring_guild }
}

scaled_estate_mercantile_guild_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_mercantile_guild }
}

scaled_estate_warriors_guild_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_warriors_guild }
}

scaled_estate_religious_order_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_religious_order }
}

scaled_estate_criminal_syndicate_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_criminal_syndicate }
}

scaled_estate_reliquary_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_reliquary }
}

scaled_estate_explorers_league_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_explorers_league }
}

scaled_estate_invention_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_invention }
}

scaled_estate_legion_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_legion }
}

scaled_estate_abyssal_maw_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_abyssal_maw }
}

scaled_estate_firelands_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_firelands }
}

scaled_estate_deepholm_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_deepholm }
}

scaled_estate_skywall_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_skywall }
}

scaled_estate_loa_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_loa }
}

scaled_estate_dragonflight_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_dragonflight }
}

scaled_estate_underling_land_share_effect = {
	scaled_estate_land_share_add_effect = { estate = estate_underling }
}

#Based on those above, but you can choose which estate you use
#example of usage: scaled_estate_land_share_add_effect = { estate = estate_nobility }
scaled_estate_land_share_add_effect = {
	if = {
		limit = {
			NOT = { total_development = 50 }
		}
		give_estate_land_share_large = { estate = $estate$ }
	}
	else_if = {
		limit = {
			total_development = 50
			NOT = { total_development = 100 }
		}
		give_estate_land_share_medium = { estate = $estate$ }
	}
	else_if = {
		limit = {
			total_development = 100
		}
		give_estate_land_share_small = { estate = $estate$ }
	}
}

#example of usage: scaled_estate_land_share_reduce_effect = { estate = estate_nobility }
scaled_estate_land_share_reduce_effect = {
	if = {
		limit = {
			NOT = { total_development = 50 }
		}
		take_estate_land_share_large = { estate = $estate$ }
	}
	else_if = {
		limit = {
			total_development = 50
			NOT = { total_development = 100 }
		}
		give_estate_land_share_medium = { estate = $estate$ }
	}
	else_if = {
		limit = {
			total_development = 100
		}
		give_estate_land_share_small = { estate = $estate$ }
	}
}

pick_random_estate_if_present = {
	random_list = {
		1 = { 
			trigger = {
				has_estate = estate_clergy
				NOT = { has_country_flag = estate_clergy_$flag$ }
			}
			set_country_flag = estate_clergy_$flag$
			[[estate_action]
			$estate_action$ = estate_clergy
			]
		}
		1 = { 
			trigger = {
				has_estate = estate_traders
				NOT = { has_country_flag = estate_traders_$flag$ }
			}
			set_country_flag = estate_traders_$flag$ 
			[[estate_action]
			$estate_action$ = estate_traders
			]
		}
		1 = { 
			trigger = {
				has_estate = estate_nobility
				NOT = { has_country_flag = estate_nobility_$flag$ }
			}
			set_country_flag = estate_nobility_$flag$
			[[estate_action]
			$estate_action$ = estate_nobility
			]
		}
		1 = { 
			trigger = {
				has_estate = estate_peasants
				NOT = { has_country_flag = estate_peasants_$flag$ }
			}
			set_country_flag = estate_peasants_$flag$
			[[estate_action]
			$estate_action$ = estate_peasants
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_slaves
				NOT = { has_country_flag = estate_slaves_$flag$ }
			}
			set_country_flag = estate_slaves_$flag$
			[[estate_action]
			$estate_action$ = estate_slaves
			]
		}
		1 = { 
			trigger = {
				has_estate = estate_tribals
				NOT = { has_country_flag = estate_tribals_$flag$ }
			}
			set_country_flag = estate_tribals_$flag$
			[[estate_action]
			$estate_action$ = estate_tribals
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_adventuring_guild
				NOT = { has_country_flag = estate_adventuring_guild_$flag$ }
			}
			set_country_flag = estate_adventuring_guild_$flag$
			[[estate_action]
			$estate_action$ = estate_adventuring_guild
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_mercantile_guild
				NOT = { has_country_flag = estate_mercantile_guild_$flag$ }
			}
			set_country_flag = estate_mercantile_guild_$flag$
			[[estate_action]
			$estate_action$ = estate_mercantile_guild
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_warriors_guild
				NOT = { has_country_flag = estate_warriors_guild_$flag$ }
			}
			set_country_flag = estate_warriors_guild_$flag$
			[[estate_action]
			$estate_action$ = estate_warriors_guild
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_religious_order
				NOT = { has_country_flag = estate_religious_order_$flag$ }
			}
			set_country_flag = estate_religious_order_$flag$
			[[estate_action]
			$estate_action$ = estate_religious_order
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_criminal_syndicate
				NOT = { has_country_flag = estate_criminal_syndicate_$flag$ }
			}
			set_country_flag = estate_criminal_syndicate_$flag$
			[[estate_action]
			$estate_action$ = estate_criminal_syndicate
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_reliquary
				NOT = { has_country_flag = estate_reliquary_$flag$ }
			}
			set_country_flag = estate_reliquary_$flag$
			[[estate_action]
			$estate_action$ = estate_reliquary
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_explorers_league
				NOT = { has_country_flag = estate_explorers_league_$flag$ }
			}
			set_country_flag = estate_explorers_league_$flag$
			[[estate_action]
			$estate_action$ = estate_explorers_league
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_invention
				NOT = { has_country_flag = estate_invention_$flag$ }
			}
			set_country_flag = estate_invention_$flag$
			[[estate_action]
			$estate_action$ = estate_invention
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_legion
				NOT = { has_country_flag = estate_legion_$flag$ }
			}
			set_country_flag = estate_legion_$flag$
			[[estate_action]
			$estate_action$ = estate_legion
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_abyssal_maw
				NOT = { has_country_flag = estate_abyssal_maw_$flag$ }
			}
			set_country_flag = estate_abyssal_maw_$flag$
			[[estate_action]
			$estate_action$ = estate_abyssal_maw
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_firelands
				NOT = { has_country_flag = estate_firelands_$flag$ }
			}
			set_country_flag = estate_firelands_$flag$
			[[estate_action]
			$estate_action$ = estate_firelands
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_deepholm
				NOT = { has_country_flag = estate_deepholm_$flag$ }
			}
			set_country_flag = estate_deepholm_$flag$
			[[estate_action]
			$estate_action$ = estate_deepholm
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_skywall
				NOT = { has_country_flag = estate_skywall_$flag$ }
			}
			set_country_flag = estate_skywall_$flag$
			[[estate_action]
			$estate_action$ = estate_skywall
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_loa
				NOT = { has_country_flag = estate_loa_$flag$ }
			}
			set_country_flag = estate_loa_$flag$
			[[estate_action]
			$estate_action$ = estate_loa
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_dragonflight
				NOT = { has_country_flag = estate_dragonflight_$flag$ }
			}
			set_country_flag = estate_dragonflight_$flag$
			[[estate_action]
			$estate_action$ = estate_dragonflight
			]
		}
        1 = { 
			trigger = {
				has_estate = estate_underling
				NOT = { has_country_flag = estate_underling_$flag$ }
			}
			set_country_flag = estate_underling_$flag$
			[[estate_action]
			$estate_action$ = estate_underling
			]
		}
	}
}

# estate = what estate
# Will give the estate 1% land
give_estate_land_share_small = {
	 change_estate_land_share = {
		estate = $estate$
		share = 1
	}
}

# estate = what estate
# Will give the estate 2% land
give_estate_land_share_medium = {
	 change_estate_land_share = {
		estate = $estate$
		share = 2
	}
}

# estate = what estate
# Will give the estate 3% land
give_estate_land_share_large = {
	 change_estate_land_share = {
		estate = $estate$
		share = 3
	}
}

# estate = what estate
# Will give the estate 5% land
give_estate_land_share_massive = {
	 change_estate_land_share = {
		estate = $estate$
		share = 5
	}
}

# estate = what estate
# Will give the estate 10% land
give_estate_land_share_gigantic = {
	 change_estate_land_share = {
		estate = $estate$
		share = 10
	}
}

give_estate_land_share_init = {
	 change_estate_land_share = {
		estate = $estate$
		share = 20
	}
}

# estate = what estate
# Will take the 1% land from estate
take_estate_land_share_small = {
	 change_estate_land_share = {
		estate = $estate$
		share = -1
	}
}

# estate = what estate
# Will take away 2% land from estate
take_estate_land_share_medium = {
	 change_estate_land_share = {
		estate = $estate$
		share = -2
	}
}

# estate = what estate
# Will take the 3% land from estate
take_estate_land_share_large = {
	 change_estate_land_share = {
		estate = $estate$
		share = -3
	}
}

# estate = what estate
# Will take the 5% land from estate
take_estate_land_share_massive = {
	 change_estate_land_share = {
		estate = $estate$
		share = -5
	}
}

# estate = what estate
# Will take the 10% land from estate
take_estate_land_share_gigantic = {
	 change_estate_land_share = {
		estate = $estate$
		share = -10
	}
}

take_estate_land_share_25 = {
	 change_estate_land_share = {
		estate = $estate$
		share = -25
	}
}

add_estate_clergy_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_clergy
        loyalty = 10
    }
}
reduce_estate_clergy_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_clergy
        loyalty = -10
    }
}
add_estate_traders_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_traders
        loyalty = 10
    }
}
reduce_estate_traders_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_traders
        loyalty = -10
    }
}
add_estate_nobility_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_nobility
        loyalty = 10
    }
}
reduce_estate_nobility_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_nobility
        loyalty = -10
    }
}
add_estate_peasants_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_peasants
        loyalty = 10
    }
}
reduce_estate_peasants_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_peasants
        loyalty = -10
    }
}
add_estate_slaves_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_slaves
        loyalty = 10
    }
}
reduce_estate_slaves_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_slaves
        loyalty = -10
    }
}
add_estate_tribals_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_tribals
        loyalty = 10
    }
}
reduce_estate_tribals_loyalty_effect = {
	add_estate_loyalty = {
        estate = estate_tribals
        loyalty = -10
    }
}

# Take lands from all estates and give it to another estate.
# $estate$ = Which estate will gain the share.
# $share$ = Total share that estate will get.
give_land_shares_to_estate_impulse = {
	if = {
		limit = {
			crown_land_share = 1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_clergy
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_clergy
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_traders
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_traders
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_nobility
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_nobility
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_peasants
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_peasants
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_slaves
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_slaves
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_tribals
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_tribals
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_adventuring_guild
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_adventuring_guild
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_mercantile_guild
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_mercantile_guild
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_warriors_guild
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_warriors_guild
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
	if = {
		limit = {
			has_estate = estate_religious_order
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_religious_order
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_criminal_syndicate
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_criminal_syndicate
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_reliquary
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_reliquary
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_explorers_league
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_explorers_league
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_invention
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_invention
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_legion
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_legion
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_abyssal_maw
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_abyssal_maw
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_firelands
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_firelands
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_deepholm
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_deepholm
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_skywall
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_skywall
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_loa
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_loa
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_dragonflight
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_dragonflight
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
    if = {
		limit = {
			has_estate = estate_underling
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		change_estate_land_share = {
			estate = estate_underling
			share = -1
		}
		change_estate_land_share = {
			estate = $estate$
			share = 1
		}
	}
}
# Take equal amount of shares from each estate and crown land and give them to another $estate$ until they have $share$ amount of share.
give_land_shares_to_estate = {
	while = {
		limit = {
			NOT = { 
				estate_territory = {
					estate = $estate$
					territory = $share$
				} 
			}
		}
		log = "Giving 1% land to guilds for each other estates."
		give_land_shares_to_estate_impulse = {
			estate = $estate$
			share = $share$
		}
	}
}

select_estate_target = {
    random_list = {
        10 = {
            trigger = {
                has_estate = estate_clergy
            }
            
            set_country_flag = estate_target_clergy
        }
        10 = {
            trigger = {
                has_estate = estate_traders
            }
            
            set_country_flag = estate_target_traders
        }
        10 = {
            trigger = {
                has_estate = estate_nobility
            }
            
            set_country_flag = estate_target_nobility
        }
        10 = {
            trigger = {
                has_estate = estate_peasants
            }
            
            set_country_flag = estate_target_peasants
        }
        10 = {
            trigger = {
                has_estate = estate_slaves
            }
            
            set_country_flag = estate_target_slaves
        }
        10 = {
            trigger = {
                has_estate = estate_tribals
            }
            
            set_country_flag = estate_target_tribals
        }
        10 = {
            trigger = {
                has_estate = estate_adventuring_guild
            }
            
            set_country_flag = estate_target_adventuring_guild
        }
        10 = {
            trigger = {
                has_estate = estate_mercantile_guild
            }
            
            set_country_flag = estate_target_mercantile_guild
        }
        10 = {
            trigger = {
                has_estate = estate_warriors_guild
            }
            
            set_country_flag = estate_target_warriors_guild
        }
        10 = {
            trigger = {
                has_estate = estate_religious_order
            }
            
            set_country_flag = estate_target_religious_order
        }
        10 = {
            trigger = {
                has_estate = estate_criminal_syndicate
            }
            
            set_country_flag = estate_target_criminal_syndicate
        }
        10 = {
            trigger = {
                has_estate = estate_reliquary
            }
            
            set_country_flag = estate_target_reliquary
        }
        10 = {
            trigger = {
                has_estate = estate_explorers_league
            }
            
            set_country_flag = estate_target_explorers_league
        }
        10 = {
            trigger = {
                has_estate = estate_invention
            }
            
            set_country_flag = estate_target_invention
        }
        10 = {
            trigger = {
                has_estate = estate_legion
            }
            
            set_country_flag = estate_target_legion
        }
        10 = {
            trigger = {
                has_estate = estate_abyssal_maw
            }
            
            set_country_flag = estate_target_abyssal_maw
        }
        10 = {
            trigger = {
                has_estate = estate_firelands
            }
            
            set_country_flag = estate_target_firelands
        }
        10 = {
            trigger = {
                has_estate = estate_deepholm
            }
            
            set_country_flag = estate_target_deepholm
        }
        10 = {
            trigger = {
                has_estate = estate_skywall
            }
            
            set_country_flag = estate_target_skywall
        }
        10 = {
            trigger = {
                has_estate = estate_loa
            }
            
            set_country_flag = estate_target_loa
        }
        10 = {
            trigger = {
                has_estate = estate_dragonflight
            }
            
            set_country_flag = estate_target_dragonflight
        }
        10 = {
            trigger = {
                has_estate = estate_underling
            }
            
            set_country_flag = estate_target_underling
        }
    }
}

clear_estate_target = {
    set_country_flag = estate_target_clergy
    set_country_flag = estate_target_traders
    set_country_flag = estate_target_nobility
    set_country_flag = estate_target_peasants
    set_country_flag = estate_target_slaves
    set_country_flag = estate_target_tribals
    set_country_flag = estate_target_adventuring_guild
    set_country_flag = estate_target_mercantile_guild
    set_country_flag = estate_target_warriors_guild
    set_country_flag = estate_target_religious_order
    set_country_flag = estate_target_criminal_syndicate
    set_country_flag = estate_target_reliquary
    set_country_flag = estate_target_explorers_league
    set_country_flag = estate_target_invention
    set_country_flag = estate_target_legion
    set_country_flag = estate_target_abyssal_maw
    set_country_flag = estate_target_firelands
    set_country_flag = estate_target_deepholm
    set_country_flag = estate_target_skywall
    set_country_flag = estate_target_loa
    set_country_flag = estate_target_dragonflight
    set_country_flag = estate_target_underling
}

grant_land_to_estate_target = {
    trigger_switch = {
        on_trigger = has_country_flag
        estate_target_clergy = {
            change_estate_land_share = {
                estate = estate_clergy
                share = $AMOUNT$
            }
        }
        estate_target_traders = {
            change_estate_land_share = {
                estate = estate_traders
                share = $AMOUNT$
            }
        }
        estate_target_nobility = {
            change_estate_land_share = {
                estate = estate_nobility
                share = $AMOUNT$
            }
        }
        estate_target_peasants = {
            change_estate_land_share = {
                estate = estate_peasants
                share = $AMOUNT$
            }
        }
        estate_target_slaves = {
            change_estate_land_share = {
                estate = estate_slaves
                share = $AMOUNT$
            }
        }
        estate_target_tribals = {
            change_estate_land_share = {
                estate = estate_tribals
                share = $AMOUNT$
            }
        }
        estate_target_adventuring_guild = {
            change_estate_land_share = {
                estate = estate_adventuring_guild
                share = $AMOUNT$
            }
        }
        estate_target_mercantile_guild = {
            change_estate_land_share = {
                estate = estate_mercantile_guild
                share = $AMOUNT$
            }
        }
        estate_target_warriors_guild = {
            change_estate_land_share = {
                estate = estate_warriors_guild
                share = $AMOUNT$
            }
        }
        estate_target_religious_order = {
            change_estate_land_share = {
                estate = estate_religious_order
                share = $AMOUNT$
            }
        }
        estate_target_criminal_syndicate = {
            change_estate_land_share = {
                estate = estate_criminal_syndicate
                share = $AMOUNT$
            }
        }
        estate_target_reliquary = {
            change_estate_land_share = {
                estate = estate_reliquary
                share = $AMOUNT$
            }
        }   
        estate_target_explorers_league = {
            change_estate_land_share = {
                estate = estate_explorers_league
                share = $AMOUNT$
            }
        }   
        estate_target_invention = {
            change_estate_land_share = {
                estate = estate_invention
                share = $AMOUNT$
            }
        }
        estate_target_legion = {
            change_estate_land_share = {
                estate = estate_legion
                share = $AMOUNT$
            }
        }
        estate_target_abyssal_maw = {
            change_estate_land_share = {
                estate = estate_abyssal_maw
                share = $AMOUNT$
            }
        }
        estate_target_firelands = {
            change_estate_land_share = {
                estate = estate_firelands
                share = $AMOUNT$
            }
        }
        estate_target_deepholm = {
            change_estate_land_share = {
                estate = estate_deepholm
                share = $AMOUNT$
            }
        }
        estate_target_skywall = {
            change_estate_land_share = {
                estate = estate_skywall
                share = $AMOUNT$
            }
        }
        estate_target_loa = {
            change_estate_land_share = {
                estate = estate_loa
                share = $AMOUNT$
            }
        }
        estate_target_dragonflight = {
            change_estate_land_share = {
                estate = estate_dragonflight
                share = $AMOUNT$
            }
        }
        estate_target_underling = {
            change_estate_land_share = {
                estate = estate_underling
                share = $AMOUNT$
            }
        }
    }
}

apply_loyalty_change_to_estate_target = {
    trigger_switch = {
        on_trigger = has_country_flag
        estate_target_clergy = {
            add_estate_loyalty = {
                estate = estate_clergy
                loyalty = $AMOUNT$
            }
        }
        estate_target_traders = {
            add_estate_loyalty = {
                estate = estate_traders
                loyalty = $AMOUNT$
            }
        }
        estate_target_nobility = {
            add_estate_loyalty = {
                estate = estate_nobility
                loyalty = $AMOUNT$
            }
        }
        estate_target_peasants = {
            add_estate_loyalty = {
                estate = estate_peasants
                loyalty = $AMOUNT$
            }
        }
        estate_target_slaves = {
            add_estate_loyalty = {
                estate = estate_slaves
                loyalty = $AMOUNT$
            }
        }
        estate_target_tribals = {
            add_estate_loyalty = {
                estate = estate_tribals
                loyalty = $AMOUNT$
            }
        }
        estate_target_adventuring_guild = {
            add_estate_loyalty = {
                estate = estate_adventuring_guild
                loyalty = $AMOUNT$
            }
        }
        estate_target_mercantile_guild = {
            add_estate_loyalty = {
                estate = estate_mercantile_guild
                loyalty = $AMOUNT$
            }
        }
        estate_target_warriors_guild = {
            add_estate_loyalty = {
                estate = estate_warriors_guild
                loyalty = $AMOUNT$
            }
        }
        estate_target_religious_order = {
            add_estate_loyalty = {
                estate = estate_religious_order
                loyalty = $AMOUNT$
            }
        }
        estate_target_criminal_syndicate = {
            add_estate_loyalty = {
                estate = estate_criminal_syndicate
                loyalty = $AMOUNT$
            }
        }
        estate_target_reliquary = {
            add_estate_loyalty = {
                estate = estate_reliquary
                loyalty = $AMOUNT$
            }
        }   
        estate_target_explorers_league = {
            add_estate_loyalty = {
                estate = estate_explorers_league
                loyalty = $AMOUNT$
            }
        }   
        estate_target_invention = {
            add_estate_loyalty = {
                estate = estate_invention
                loyalty = $AMOUNT$
            }
        }
        estate_target_legion = {
            add_estate_loyalty = {
                estate = estate_legion
                loyalty = $AMOUNT$
            }
        }
        estate_target_abyssal_maw = {
            add_estate_loyalty = {
                estate = estate_abyssal_maw
                loyalty = $AMOUNT$
            }
        }
        estate_target_firelands = {
            add_estate_loyalty = {
                estate = estate_firelands
                loyalty = $AMOUNT$
            }
        }
        estate_target_deepholm = {
            add_estate_loyalty = {
                estate = estate_deepholm
                loyalty = $AMOUNT$
            }
        }
        estate_target_skywall = {
            add_estate_loyalty = {
                estate = estate_skywall
                loyalty = $AMOUNT$
            }
        }
        estate_target_loa = {
            add_estate_loyalty = {
                estate = estate_loa
                loyalty = $AMOUNT$
            }
        }
        estate_target_dragonflight = {
            add_estate_loyalty = {
                estate = estate_dragonflight
                loyalty = $AMOUNT$
            }
        }
        estate_target_underling = {
            add_estate_loyalty = {
                estate = estate_underling
                loyalty = $AMOUNT$
            }
        }
    }
}

#----------------------------------------
# Seize Land
#----------------------------------------
# Take loyalty and land from each estate
seize_land_from_estate = {
    if = {
        limit = {
            [[has_exception]
                NOT = { has_estate_privilege = estate_$ESTATE$_exception }
            ]
            has_estate = estate_$ESTATE$
        }
        
        change_estate_land_share = {
            estate = estate_$ESTATE$
            share = $AMOUNT$
        }
        
        add_estate_loyalty = {
            estate = estate_$ESTATE$
            loyalty = -20
            short = yes
        }
    }
}

# 
seize_land_effect = {
	hidden_effect = {
        spawn_rebels_from_unhappy_estate = { ESTATE = clergy                SIZE = 1    REBEL = estate_clergy_rebels                }
        spawn_rebels_from_unhappy_estate = { ESTATE = traders               SIZE = 1    REBEL = estate_traders_rebels               }
        spawn_rebels_from_unhappy_estate = { ESTATE = nobility              SIZE = 1    REBEL = estate_nobility_rebels              }
        spawn_rebels_from_unhappy_estate = { ESTATE = peasants              SIZE = 1    REBEL = estate_peasants_rebels              }
        spawn_rebels_from_unhappy_estate = { ESTATE = tribals               SIZE = 1    REBEL = estate_tribals_rebels               }
        spawn_rebels_from_unhappy_estate = { ESTATE = slaves                SIZE = 1    REBEL = estate_slaves_rebels                }
        spawn_rebels_from_unhappy_estate = { ESTATE = adventuring_guild     SIZE = 1    REBEL = estate_adventuring_guild_rebels     }
        spawn_rebels_from_unhappy_estate = { ESTATE = mercantile_guild      SIZE = 1    REBEL = estate_mercantile_guild_rebels      }
        spawn_rebels_from_unhappy_estate = { ESTATE = warriors_guild        SIZE = 1    REBEL = estate_warriors_guild_rebels        }
        spawn_rebels_from_unhappy_estate = { ESTATE = religious_order       SIZE = 1    REBEL = estate_religious_order_rebels       }
        spawn_rebels_from_unhappy_estate = { ESTATE = criminal_syndicate    SIZE = 1    REBEL = estate_criminal_syndicate_rebels    }
        spawn_rebels_from_unhappy_estate = { ESTATE = reliquary             SIZE = 1    REBEL = estate_reliquary_rebels             }
        spawn_rebels_from_unhappy_estate = { ESTATE = explorers_league      SIZE = 1    REBEL = estate_explorers_league_rebels      }
        spawn_rebels_from_unhappy_estate = { ESTATE = invention             SIZE = 1    REBEL = estate_invention_rebels             }
        spawn_rebels_from_unhappy_estate = { ESTATE = legion                SIZE = 1    REBEL = estate_legion_rebels                }
        spawn_rebels_from_unhappy_estate = { ESTATE = abyssal_maw           SIZE = 1    REBEL = estate_abyssal_maw_rebels           }
        spawn_rebels_from_unhappy_estate = { ESTATE = firelands             SIZE = 1    REBEL = estate_firelands_rebels             }
        spawn_rebels_from_unhappy_estate = { ESTATE = deepholm              SIZE = 1    REBEL = estate_deepholm_rebels              }
        spawn_rebels_from_unhappy_estate = { ESTATE = skywall               SIZE = 1    REBEL = estate_skywall_rebels               }
        spawn_rebels_from_unhappy_estate = { ESTATE = loa                   SIZE = 1    REBEL = estate_loa_rebels                   }
        spawn_rebels_from_unhappy_estate = { ESTATE = dragonflight          SIZE = 1    REBEL = estate_dragonflight_rebels          }
        spawn_rebels_from_unhappy_estate = { ESTATE = underling             SIZE = 1    REBEL = estate_underling_rebels             }
	}
}

spawn_rebels_from_unhappy_estate = {
    random_owned_province = {
        limit = {
            is_in_capital_area = yes
            NOT = { has_siege = yes } # i.e. rebels are not present
        }
        
        if = {
            limit = {
                owner = {
                    has_estate = estate_$ESTATE$
					NOT = {
						estate_loyalty = {
							estate = estate_$ESTATE$
							loyalty = 30
						}
					}
                }
            }
            
            add_named_unrest = { 
                name = estate_land_seized 
                value = 10 
            }  
            
            spawn_rebels = {
				type = $REBEL$
				size = $SIZE$
			}
        }
    }
}

estate_rebel_effect = {
    add_estate_loyalty = {
        estate = estate_$ESTATE$
        loyalty = 30
    }
    change_estate_land_share = {
        estate = estate_$ESTATE$
        share = 5
    }
    add_country_modifier = {
        name = estate_$ESTATE$_supremacy
        duration = 3650
    }
}