namespace = wwu_setup_orc

# Twilight's Hammer
country_event = {
	id = wwu_setup_orc.1
	title = wwu_setup_orc.1.title
	desc = wwu_setup_orc.1.desc
	picture = TWILIGHT_GEOMANCER_eventPicture

	fire_only_once = yes
    major = yes
    
    major_trigger = {
        capital_scope = {
            continent = continent_draenor
        }
    }
    
	trigger = {
        # Fire for player if they are in relevant region
        if = {
            limit = {
                ai = no
                has_country_flag = host_player
            }
            capital_scope = {
                continent = continent_draenor
            }
        }
        # Otherwise fire for a random country in the region
        else = {
            any_country = {
                capital_scope = {
                    continent = continent_draenor
                }
            }
        }
        
        NOT = { exists = A43 }
        NOT = { has_global_flag = setup_twilights_hammer }
        is_year = 550
        NOT = { has_global_flag = setup_outland }
        NOT = { has_global_flag = old_horde_country_setup }
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = setup_twilights_hammer
        }
    }
    
    mean_time_to_happen = {
		months = 240
        
        modifier = {
            factor = 0.5
            
            ai = no
        }
	}

	option = {
		name = wwu_setup_orc.1.option.a
        
        3756 = {
            cede_province = A43
            add_core = A43
            change_culture = culture_twilight_cultist
            change_religion = twilight_cult
        }
        3762 = {
            cede_province = A43
            add_core = A43
            change_culture = culture_twilight_cultist
            change_religion = twilight_cult
        }
        
        ai_chance = {
            factor = 100
        }
	}
	option = {
		name = wwu_setup_orc.1.option.b
        
        trigger = {
            OR = {
                3756 = {
                    owned_by = ROOT
                }
                3762 = {
                    owned_by = ROOT
                }
            }
        }
        
        3756 = {
            add_core = A43
            change_culture = culture_twilight_cultist
            change_religion = twilight_cult
        }
        3762 = {
            add_core = A43
            change_culture = culture_twilight_cultist
            change_religion = twilight_cult
        }
        
        ai_chance = {
            factor = 0
        }
	}
}

# Orgrimmar
country_event = {
	id = wwu_setup_orc.10
	title = wwu_setup_orc.10.title
	desc = wwu_setup_orc.10.desc
	picture = ENTERING_ORGRIMMAR_eventPicture

	fire_only_once = yes
    major = yes
    
    major_trigger = {
        OR = {
            has_country_modifier = member_of_alliance
            culture_group = culture_group_human
            culture_group = culture_group_orc
            culture_group = culture_group_tauren
            culture_group = culture_group_goblin
            culture_group = culture_group_undead
        }
    }
    
	trigger = {
        # Fire for player if they are in relevant region
        if = {
            limit = {
                ai = no
                has_country_flag = host_player
            }
            capital_scope = {
                continent = continent_kalimdor
            }
        }
        # Otherwise fire for a random country in the region
        else = {
            any_country = {
                capital_scope = {
                    continent = continent_kalimdor
                }
            }
        }
        
        NOT = { exists = A48 }
        NOT = { has_global_flag = setup_orgrimmar }
        
        # Set by the Thrall story event chain
        had_global_flag = {
            flag = thralls_journey
            days = 365
        }
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = setup_orgrimmar
        }
    }
    
    mean_time_to_happen = {
		months = 240
        
        modifier = {
            factor = 0.5
            
            ai = no
        }
	}

	option = {
		name = wwu_setup_orc.10.option.a
        
        area_orgrimmar = {
            cede_province = A48
            add_core = A48
            change_culture = culture_orc
            change_religion = shamanism
        }
        area_orgrimmar_exterior = {
            cede_province = A48
            add_core = A48
            change_culture = culture_orc
            change_religion = shamanism
        }
        
        hidden_effect = {
            A48 = {
                country_event = { id = wwu_setup_orc.11 days = 1 }
            }
        }
        
        ai_chance = {
            factor = 100
        }
	}
	option = {
		name = wwu_setup_orc.10.option.b
        
        trigger = {
            OR = {
                area_orgrimmar = {
                    owned_by = ROOT
                }
                area_orgrimmar_exterior = {
                    owned_by = ROOT
                }
            }
        }
        
        area_orgrimmar = {
            add_core = A48
            change_culture = culture_orc
            change_religion = shamanism
        }
        area_orgrimmar_exterior = {
            cede_province = A48
            add_core = A48
            change_culture = culture_orc
            change_religion = shamanism
        }
        
        ai_chance = {
            factor = 0
        }
	}
    
    after = {   
        random_country = {
            limit = {
                OR = {
                    AND = {
                        ai = no
                        has_country_flag = host_player
                    }
                    is_great_power = yes
                }
            }
            
            country_event = { id = wwu_setup_orc.12 random = 90 }
        }
    }
}

# Orgrimmar - Setup Country
country_event = {
	id = wwu_setup_orc.11
	title = wwu_setup_orc.11.title
	desc = wwu_setup_orc.11.desc
	picture = ENTERING_ORGRIMMAR_eventPicture

	is_triggered_only = yes

    mean_time_to_happen = {
		days = 1
	}

    immediate = {
        hidden_effect = {
            set_country_flag = ignore_horde_vote
        }
    }

	option = {
		name = wwu_setup_orc.11.option.a
        
        hidden_effect = {
            set_global_flag = setup_the_horde
            set_global_flag = horde_exists
        }
        
        set_head_of_faction = {
            faction = horde
        }
        set_member_of_faction = {
            faction = horde
        }
        
        define_ruler = {
            name = "Thrall"
            dynasty = "Durotan"
            adm = 4
            dip = 6
            mil = 5
            min_age = 20
            max_age = 30
        }
            
        set_ruler_flag = is_immortal
        set_ruler_flag = shaman_personality
        set_ruler_flag = ruler_portrait_thrall
        
        setup_spellcaster_history = {
            APTITUDE = 3
            FINESSE = 3
            CONCENTRATION = 3
            MANA = 5
            shaman = yes
        }
        
        unlock_artifact = {
            artifact = doomhammer
        }
	}
    
    after = {
        hidden_effect = {
            clr_country_flag = ignore_horde_vote
            reveal_all_discovery = yes
        }
    }
}

# Warsong Escapades
country_event = {
	id = wwu_setup_orc.12
	title = wwu_setup_orc.12.title
	desc = wwu_setup_orc.12.desc
	picture = GROMMASH_HELLSCREAM_eventPicture

	is_triggered_only = yes
    
	trigger = {
        NOT = { has_global_flag = setup_warsong }
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = setup_warsong
        }
    }
    
    mean_time_to_happen = {
		days = 1
	}

	option = {
		name = wwu_setup_orc.12.option.a
        
        area_splintertree_post = {
            cede_province = A35
            add_core = A35
            change_culture = culture_orc
            change_religion = shamanism
        }
        
        hidden_effect = {
            A35 = {
                country_event = { id = wwu_setup_orc.13 days = 1 }
            }
        }
        
        ai_chance = {
            factor = 100
        }
	}
	option = {
		name = wwu_setup_orc.12.option.b
        
        trigger = {
            area_splintertree_post = {
                owned_by = ROOT
            }
        }
        
        area_splintertree_post = {
            add_core = A35
            change_culture = culture_orc
            change_religion = shamanism
        }
        
        ai_chance = {
            factor = 0
        }
	}
}

# Warsong - Setup Country
country_event = {
	id = wwu_setup_orc.13
	title = wwu_setup_orc.13.title
	desc = wwu_setup_orc.13.desc
	picture = GROMMASH_HELLSCREAM_eventPicture

	is_triggered_only = yes

    mean_time_to_happen = {
		days = 1
	}

	option = {
		name = wwu_setup_orc.13.option.a
        
        if = {
            limit = {
                ai = yes
            }
            
            define_ruler = { 
                name = "Grom" 
                dynasty = "Hellscream" 
                adm = 2
                dip = 2
                mil = 6
                min_age = 60
                max_age = 90
            }
            
            set_ruler_flag = ruler_portrait_grommash
        }
        else = {
            add_legitimacy = 25
        }
	}
    
    after = {
        hidden_effect = {
            reveal_all_discovery = yes
        }
    }
}

# Black Tooth Grin - Spawn
country_event = {
	id = wwu_setup_orc.14
	title = wwu_setup_orc.14.title
	desc = wwu_setup_orc.14.desc
	picture = REND_BLACKHAND_eventPicture

	fire_only_once = yes
    major = yes
    
    major_trigger = {
        OR = {
            has_country_modifier = member_of_horde
            capital_scope = {
                continent = continent_eastern_kingdoms
            }
        }
    }
    
	trigger = {
        # Fire for player if they are in relevant region
        if = {
            limit = {
                ai = no
                has_country_flag = host_player
            }
            capital_scope = {
                continent = continent_eastern_kingdoms
            }
        }
        # Otherwise fire for a random country in the region
        else = {
            any_country = {
                capital_scope = {
                    continent = continent_eastern_kingdoms
                }
            }
        }
        
        NOT = { exists = P98 }
        NOT = { has_global_flag = setup_black_tooth_grin }
        
        # 50 years after Orcish invasion
        had_global_flag = {
            flag = orcish_horde_established
            days = 18250
        }
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = setup_black_tooth_grin
        }
    }
    
    mean_time_to_happen = {
		months = 240
        
        modifier = {
            factor = 0.5
            
            ai = no
        }
	}

	option = {
		name = wwu_setup_orc.14.option.a
        
        area_blackrock_exterior = {
            cede_province = P98
            add_core = P98
            change_culture = culture_orc
            change_religion = fel
        }
        area_blackrock_valley = {
            cede_province = P98
            add_core = P98
            change_culture = culture_orc
            change_religion = fel
        }
        area_blackrock_mountain = {
            limit = { 
                NOT = { province_id = 3155 }
            }
            cede_province = P98
            add_core = P98
            change_culture = culture_orc
            change_religion = fel
        }
        
        hidden_effect = {
            P98 = {
                country_event = { id = wwu_setup_orc.15 days = 1 }
            }
        }
        
        ai_chance = {
            factor = 100
        }
	}
	option = {
		name = wwu_setup_orc.14.option.b
        
        trigger = {
            area_blackrock_mountain = {
                owned_by = ROOT
            }
        }
        
        area_blackrock_exterior = {
            add_core = P98
            change_culture = culture_orc
            change_religion = fel
        }
        area_blackrock_valley = {
            add_core = P98
            change_culture = culture_orc
            change_religion = fel
        }
        area_blackrock_mountain = {
            limit = { 
                NOT = { province_id = 3155 }
            }
            add_core = P98
            change_culture = culture_orc
            change_religion = fel
        }
        
        ai_chance = {
            factor = 0
        }
	}
}

# Black Tooth Grin - Setup
country_event = {
	id = wwu_setup_orc.15
	title = wwu_setup_orc.15.title
	desc = wwu_setup_orc.15.desc
	picture = REND_BLACKHAND_eventPicture

	is_triggered_only = yes

    mean_time_to_happen = {
		days = 1
	}

	option = {
		name = wwu_setup_orc.15.option.a
        
        define_ruler = { 
            name = "Rend" 
            dynasty = "Blackhand" 
            adm = 2
            dip = 2
            mil = 7
            min_age = 50
            max_age = 70
        }
	}
    
    after = {
        hidden_effect = {
            reveal_all_discovery = yes
        }
    }
}

# Dragonmaw - Spawn
country_event = {
	id = wwu_setup_orc.16
	title = wwu_setup_orc.16.title
	desc = wwu_setup_orc.16.desc
	picture = GRIM_BATOL_eventPicture

	fire_only_once = yes
    major = yes
    
    major_trigger = {
        OR = {
            has_country_modifier = member_of_horde
            capital_scope = {
                continent = continent_eastern_kingdoms
            }
        }
    }
    
	trigger = {
        # Fire for player if they are in relevant region
        if = {
            limit = {
                ai = no
                has_country_flag = host_player
            }
            capital_scope = {
                continent = continent_eastern_kingdoms
            }
        }
        # Otherwise fire for a random country in the region
        else = {
            any_country = {
                capital_scope = {
                    continent = continent_eastern_kingdoms
                }
            }
        }
        
        #NOT = { exists = A45 }
        NOT = { started_in = 598.1.1 }
        NOT = { has_global_flag = setup_dragonmaw }
        
        # 50 years after Orcish invasion
        had_global_flag = {
            flag = orcish_horde_established
            days = 9125
        }
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = setup_dragonmaw
        }
    }
    
    mean_time_to_happen = {
		months = 240
        
        modifier = {
            factor = 0.5
            
            ai = no
        }
	}

	option = {
		name = wwu_setup_orc.16.option.a
        
        area_grim_batol = {
            cede_province = A45
            add_core = A45
            change_culture = culture_orc
            change_religion = fel
        }
        
        hidden_effect = {
            A45 = {
                country_event = { id = wwu_setup_orc.17 days = 1 }
            }
        }
        
        ai_chance = {
            factor = 100
        }
	}
	option = {
		name = wwu_setup_orc.16.option.b
        
        trigger = {
            area_grim_batol = {
                owned_by = ROOT
            }
        }
        
        area_grim_batol = {
            add_core = A45
            change_culture = culture_orc
            change_religion = fel
        }
        
        ai_chance = {
            factor = 0
        }
	}
}

# Dragonmaw - Setup
country_event = {
	id = wwu_setup_orc.17
	title = wwu_setup_orc.17.title
	desc = wwu_setup_orc.17.desc
	picture = GRIM_BATOL_eventPicture

	is_triggered_only = yes

    mean_time_to_happen = {
		days = 1
	}

	option = {
		name = wwu_setup_orc.17.option.a
        
        if = {
            limit = {
                ai = yes
            }
            define_ruler = {
                name = "Zuluhed" 
                dynasty = "the Whacked" 
                adm = 4
                dip = 3
                mil = 3
                min_age = 40
                max_age = 60
            }
            
            if = {
                limit = {
                    NOT = { religion = fel }
                }
                change_religion = fel
            }
            
            set_capital = 1061
        }
        else = {
            add_legitimacy = 25
        }
        
        add_country_modifier = {
            name = demon_soul_dragonmaw
            duration = -1
        }
        
        # Subjugate Vermillion Redoubt
        if = {
            limit = {
                exists = V01
            }
            
            create_subject = {
                subject_type = vassal
                who = V01
            }
        }
        
        # Horde alliance
        if = {
            limit = {
                exists = U03
            }
            
            create_alliance = U03
        }
	}
    
    after = {
        hidden_effect = {
            reveal_all_discovery = yes
        }
    }
}

# Frostwolf - Spawn
country_event = {
	id = wwu_setup_orc.18
	title = wwu_setup_orc.18.title
	desc = wwu_setup_orc.18.desc
	picture = FROSTWOLF_WARLORD_eventPicture

	fire_only_once = yes
    major = yes
    
    major_trigger = {
        OR = {
            has_country_modifier = member_of_horde
            capital_scope = {
                continent = continent_eastern_kingdoms
            }
        }
    }
    
	trigger = {
        # Fire for player if they are in relevant region
        if = {
            limit = {
                ai = no
                has_country_flag = host_player
            }
            capital_scope = {
                continent = continent_eastern_kingdoms
            }
        }
        # Otherwise fire for a random country in the region
        else = {
            any_country = {
                capital_scope = {
                    continent = continent_eastern_kingdoms
                }
            }
        }
        
        NOT = { started_in = 598.1.1 }
        NOT = { has_global_flag = setup_frostwolf }
        
        # 50 years after Orcish invasion
        had_global_flag = {
            flag = orcish_horde_established
            days = 3650
        }
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = setup_frostwolf
        }
    }
    
    mean_time_to_happen = {
		months = 240
        
        modifier = {
            factor = 0.5
            
            ai = no
        }
	}

	option = {
		name = wwu_setup_orc.18.option.a
        
        area_dun_baldar = {
            cede_province = A46
            add_core = A46
            change_culture = culture_orc
            change_religion = shamanism
        }
        area_frostwolf_keep = {
            cede_province = A46
            add_core = A46
            change_culture = culture_orc
            change_religion = shamanism
        }
        
        hidden_effect = {
            A46 = {
                country_event = { id = wwu_setup_orc.19 days = 1 }
            }
        }
        
        ai_chance = {
            factor = 100
        }
	}
	option = {
		name = wwu_setup_orc.18.option.b
        
        trigger = { 
            OR = {
                area_frostwolf_keep = {
                    owned_by = ROOT
                }
                area_dun_baldar = {
                    owned_by = ROOT
                }
            }
        }
        
        area_dun_baldar = {
            add_core = A46
            change_culture = culture_orc
            change_religion = shamanism
        }
        area_frostwolf_keep = {
            add_core = A46
            change_culture = culture_orc
            change_religion = shamanism
        }
        
        ai_chance = {
            factor = 0
        }
	}
}

# Frostwolf - Setup
country_event = {
	id = wwu_setup_orc.19
	title = wwu_setup_orc.19.title
	desc = wwu_setup_orc.19.desc
	picture = FROSTWOLF_WARLORD_eventPicture

	is_triggered_only = yes

    mean_time_to_happen = {
		days = 1
	}

	option = {
		name = wwu_setup_orc.19.option.a
        
        if = {
            limit = {
                ai = yes
            }
            define_ruler = {
                name = "Durotan" 
                dynasty = "Frostwolf" 
                adm = 6
                dip = 3
                mil = 4
                min_age = 50
                max_age = 80
            }
            
            set_ruler_flag = ruler_portrait_durotan
            
            if = {
                limit = {
                    religion = fel
                }
                change_religion = shamanism
            }
            
            set_capital = 3061
        }
        
        if = {
            limit = {
                has_country_modifier = member_of_old_horde
            }
            
            remove_country_modifier = member_of_old_horde
        }
        
        # Horde alliance
        if = {
            limit = {
                exists = U03
            }
            
            create_alliance = U03
        }
	}
    
    after = {
        hidden_effect = {
            reveal_all_discovery = yes
        }
    }
}

